var bind=function(e,t){return function(){return e.apply(t,arguments)}};(function(e,t){var n;n=function(){function t(t,n,r){this.onEvent=bind(this.onEvent,this);var i,a,l;i=e(t);a=this;l={root:"/",script:"/files/filetree",folderEvent:"click",expandSpeed:500,collapseSpeed:500,expandEasing:"swing",collapseEasing:"swing",multiFolder:true,loadMessage:"Loading...",errorMessage:"Unable to get file tree information",multiSelect:false,onlyFolders:false,onlyFiles:false,preventLinkAction:false};this.jqft={container:i};this.options=e.extend(l,n);this.callback=r;this.data={};i.html('<ul class="jqueryFileTree start"><li class="wait">'+this.options.loadMessage+"<li></ul>");a.showTree(i,escape(this.options.root),(function(){return a._trigger("filetreeinitiated",{})}));i.delegate("li a",this.options.folderEvent,a.onEvent)}t.prototype.onEvent=function(t){var n,r,i,a,l,s;n=e(t.target);l=this.options;a=this.jqft;r=this;i=this.callback;r.data={};r.data.li=n.closest("li");r.data.type=(s=r.data.li.hasClass("directory"))!=null?s:{directory:"file"};r.data.value=n.text();r.data.rel=n.prop("rel");r.data.container=a.container;if(l.preventLinkAction){t.preventDefault()}if(n.parent().hasClass("directory")){r.jqft.container.find("LI.directory").removeClass("selected");n.parent().addClass("selected");if(n.parent().hasClass("collapsed")){if(!l.multiFolder){n.parent().parent().find("UL").slideUp({duration:l.collapseSpeed,easing:l.collapseEasing});n.parent().parent().find("LI.directory").removeClass("expanded").addClass("collapsed")}n.parent().removeClass("collapsed").addClass("expanded");n.parent().find("UL").remove();return r.showTree(n.parent(),n.attr("rel"),(function(){r._trigger("filetreeexpanded",r.data);return i!=null}))}else{return n.parent().find("UL").slideUp({duration:l.collapseSpeed,easing:l.collapseEasing,start:function(){return r._trigger("filetreecollapse",r.data)},complete:function(){n.parent().removeClass("expanded").addClass("collapsed");r._trigger("filetreecollapsed",r.data);return i!=null}})}}else{if(!l.multiSelect){a.container.find("li").removeClass("selected");n.parent().addClass("selected")}else{if(n.parent().find("input").is(":checked")){n.parent().find("input").prop("checked",false);n.parent().removeClass("selected")}else{n.parent().find("input").prop("checked",true);n.parent().addClass("selected")}}r._trigger("filetreeclicked",r.data);return typeof i==="function"?i(n.attr("rel")):void 0}};t.prototype.showTree=function(t,n,r){var i,a,l,s,o,d,p;i=e(t);d=this.options;a=this;i.addClass("wait");e(".jqueryFileTree.start").remove();l={dir:n,onlyFolders:d.onlyFolders,onlyFiles:d.onlyFiles,multiSelect:d.multiSelect};o=function(t){var l;i.find(".start").html("");i.removeClass("wait").append(t);if(d.root===n){i.find("UL:hidden").show(typeof callback!=="undefined"&&callback!==null)}else{if(jQuery.easing[d.expandEasing]===void 0){console.log("Easing library not loaded. Include jQueryUI or 3rd party lib.");d.expandEasing="swing"}i.find("UL:hidden").slideDown({duration:d.expandSpeed,easing:d.expandEasing,start:function(){return a._trigger("filetreeexpand",a.data)},complete:r})}l=e('[rel="'+decodeURIComponent(n)+'"]').parent();if(d.multiSelect&&l.children("input").is(":checked")){l.find("ul li input").each((function(){e(this).prop("checked",true);return e(this).parent().addClass("selected")}))}return false};s=function(){i.find(".start").html("");i.removeClass("wait").append("<p>"+d.errorMessage+"</p>");return false};if(typeof d.script==="function"){p=d.script(l);if(typeof p==="string"||p instanceof jQuery){return o(p)}else{return s()}}else{return e.ajax({url:d.script,type:"POST",dataType:"HTML",data:l}).done((function(e){return o(e)})).fail((function(){return s()}))}};t.prototype._trigger=function(e,t){var n;n=this.jqft.container;return n.triggerHandler(e,t)};return t}();return e.fn.extend({fileTree:function(t,r){return this.each((function(){var i,a;i=e(this);a=i.data("fileTree");if(!a){i.data("fileTree",a=new n(this,t,r))}if(typeof t==="string"){return a[option].apply(a)}}))}})})(window.jQuery,window);